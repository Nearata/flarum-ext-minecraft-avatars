{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@nearata/flarum-ext-minecraft-avatars/webpack/bootstrap","webpack://@nearata/flarum-ext-minecraft-avatars/webpack/runtime/compat get default export","webpack://@nearata/flarum-ext-minecraft-avatars/webpack/runtime/define property getters","webpack://@nearata/flarum-ext-minecraft-avatars/webpack/runtime/hasOwnProperty shorthand","webpack://@nearata/flarum-ext-minecraft-avatars/webpack/runtime/make namespace object","webpack://@nearata/flarum-ext-minecraft-avatars/external root \"flarum.core.compat['common/extend']\"","webpack://@nearata/flarum-ext-minecraft-avatars/external root \"flarum.core.compat['forum/app']\"","webpack://@nearata/flarum-ext-minecraft-avatars/external root \"flarum.core.compat['common/components/Button']\"","webpack://@nearata/flarum-ext-minecraft-avatars/external root \"flarum.core.compat['common/models/User']\"","webpack://@nearata/flarum-ext-minecraft-avatars/external root \"flarum.core.compat['forum/components/AvatarEditor']\"","webpack://@nearata/flarum-ext-minecraft-avatars/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@nearata/flarum-ext-minecraft-avatars/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@nearata/flarum-ext-minecraft-avatars/./src/forum/components/ChangeMinotarModal.js","webpack://@nearata/flarum-ext-minecraft-avatars/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@nearata/flarum-ext-minecraft-avatars/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/AvatarEditor'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","import Button from \"flarum/common/components/Button\";\nimport Modal from \"flarum/common/components/Modal\";\n\nexport default class ChangeMinotarModal extends Modal {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.user = this.attrs.user\n\n        this.success = false;\n        this.oldMinotar = this.user.attribute(\"minotar\");\n        this.minotar = this.user.attribute(\"minotar\");\n    }\n\n    className() {\n        return \"NearataMinecraftAvatarsModal Modal--small\";\n    }\n\n    title() {\n        return app.translator.trans(\"nearata-minecraft-avatars.forum.title\");\n    }\n\n    content() {\n        return [\n            m(\".Modal-body\", [\n                m(\".Form.Form--centered\", [\n                    this.success\n                        ? [\n                              m(\n                                  \"p.helpText\",\n                                  app.translator.trans(\n                                      \"nearata-minecraft-avatars.forum.avatar_changed\"\n                                  )\n                              ),\n                              m(\".Form-group\", [\n                                  m(\n                                      Button,\n                                      {\n                                          class: \"Button Button--primary Button--block\",\n                                          onclick: this.hide.bind(this),\n                                      },\n                                      app.translator.trans(\n                                          \"nearata-minecraft-avatars.forum.dismiss_button\"\n                                      )\n                                  ),\n                              ]),\n                          ]\n                        : [\n                              m(\n                                  \"p.helpText\",\n                                  app.translator.trans(\n                                      \"nearata-minecraft-avatars.forum.help_text\"\n                                  )\n                              ),\n                              m(\".Form-group\", [\n                                  m(\"input\", {\n                                      type: \"name\",\n                                      name: \"minotar\",\n                                      class: \"FormControl\",\n                                      placeholder: this.oldMinotar || \"Notch\",\n                                      oninput: (e) =>\n                                          (this.minotar = e.target.value),\n                                      disabled: this.loading,\n                                      autocomplete: \"off\",\n                                  }),\n                              ]),\n                              m(\".Form-group\", [\n                                  m(\n                                      Button,\n                                      {\n                                          class: \"Button Button--primary Button--block\",\n                                          type: \"submit\",\n                                          loading: this.loading,\n                                      },\n                                      app.translator.trans(\n                                          \"nearata-minecraft-avatars.forum.submit_button\"\n                                      )\n                                  ),\n                              ]),\n                          ],\n                ]),\n            ]),\n            m(\".Modal-footer\", [\n                m(\"span\", [\n                    \"Powered by \",\n                    m(\n                        \"a\",\n                        {\n                            href: \"https://crafatar.com/\",\n                            target: \"_blank\",\n                        },\n                        \"Crafatar\"\n                    ),\n                ]),\n            ]),\n        ];\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        if (this.minotar === this.oldMinotar) {\n            this.hide();\n            return;\n        }\n\n        this.loading = true;\n        this.alertAttrs = null;\n\n        this.user\n            .save(\n                {\n                    minotar: this.minotar,\n                },\n                {\n                    errorHandler: this.onerror.bind(this),\n                    meta: { minotar: this.minotar },\n                }\n            )\n            .then(() => (this.success = true))\n            .catch(() => {})\n            .then(this.loaded.bind(this));\n    }\n\n    loaded() {\n        delete this.user.avatarColor\n\n        super.loaded()\n    }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import { extend, override } from \"flarum/common/extend\";\nimport app from \"flarum/forum/app\";\nimport Button from \"flarum/common/components/Button\";\nimport User from \"flarum/common/models/User\";\nimport AvatarEditor from \"flarum/forum/components/AvatarEditor\";\n\nimport ChangeMinotarModal from \"./components/ChangeMinotarModal\";\n\napp.initializers.add(\"nearata-minecraft-avatars\", () => {\n    const baseUrl = \"https://crafatar.com\";\n\n    User.prototype.avatarUrl = function () {\n        const avatarUrl = this.attribute(\"avatarUrl\");\n        const minotar = this.attribute(\"minotar\");\n\n        if (minotar) {\n            return baseUrl + \"/avatars/\" + minotar + \"?size=64\";\n        }\n\n        return avatarUrl;\n    };\n\n    extend(AvatarEditor.prototype, \"controlItems\", function (items) {\n        const minotar = this.attrs.user.attribute(\"minotar\");\n        const changeButton = app.translator.trans(\n            \"nearata-minecraft-avatars.forum.change_button\"\n        );\n        const useButton = app.translator.trans(\n            \"nearata-minecraft-avatars.forum.use_button\"\n        );\n\n        items.add(\n            \"nearataMinecraftAvatars\",\n            m(\n                Button,\n                {\n                    icon: \"fas fa-cloud-upload-alt\",\n                    onclick: () => app.modal.show(ChangeMinotarModal, {\"user\": this.attrs.user}),\n                },\n                minotar ? changeButton : useButton\n            ),\n            1\n        );\n\n        const avatarUrl = this.attrs.user.avatarUrl();\n\n        if (avatarUrl) {\n            if (avatarUrl.startsWith(baseUrl)) {\n                items.remove(\"upload\");\n            } else {\n                items.remove(\"nearataMinecraftAvatars\");\n            }\n        } else {\n            items.remove(\"remove\");\n        }\n    });\n\n    override(AvatarEditor.prototype, \"quickUpload\", () => {\n        return;\n    });\n\n    extend(AvatarEditor.prototype, \"remove\", function () {\n        const minotar = this.attrs.user.attribute(\"minotar\");\n\n        if (minotar) {\n            this.attrs.user\n                .save({\n                    minotar: \"\",\n                })\n                .then(this.success.bind(this), this.failure.bind(this));\n        }\n    });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","ChangeMinotarModal","subClass","superClass","create","constructor","oninit","vnode","this","user","attrs","success","oldMinotar","attribute","minotar","className","title","app","translator","trans","content","m","Button","class","onclick","hide","type","name","placeholder","oninput","e","target","disabled","loading","autocomplete","href","onsubmit","preventDefault","alertAttrs","save","errorHandler","onerror","meta","then","loaded","avatarColor","Modal","baseUrl","User","avatarUrl","extend","AvatarEditor","items","changeButton","useButton","add","icon","startsWith","remove","override","failure"],"sourceRoot":""}