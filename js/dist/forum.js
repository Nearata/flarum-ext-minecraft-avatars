(()=>{var t={n:a=>{var r=a&&a.__esModule?()=>a.default:()=>a;return t.d(r,{a:r}),r},d:(a,r)=>{for(var o in r)t.o(r,o)&&!t.o(a,o)&&Object.defineProperty(a,o,{enumerable:!0,get:r[o]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},a={};(()=>{"use strict";t.r(a);const r=flarum.core.compat["common/extend"],o=flarum.core.compat["forum/app"];var e=t.n(o);const n=flarum.core.compat["common/components/Button"];var s=t.n(n);const i=flarum.core.compat["common/models/User"];var u=t.n(i);const c=flarum.core.compat["forum/components/AvatarEditor"];var l=t.n(c);function p(t,a){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},p(t,a)}const f=flarum.core.compat["common/components/Modal"];var d=function(t){var a,r;function o(){return t.apply(this,arguments)||this}r=t,(a=o).prototype=Object.create(r.prototype),a.prototype.constructor=a,p(a,r);var e=o.prototype;return e.oninit=function(a){t.prototype.oninit.call(this,a),this.user=this.attrs.user,this.success=!1,this.oldMinotar=this.user.attribute("minotar"),this.minotar=this.user.attribute("minotar")},e.className=function(){return"NearataMinecraftAvatarsModal Modal--small"},e.title=function(){return app.translator.trans("nearata-minecraft-avatars.forum.title")},e.content=function(){var t=this;return[m(".Modal-body",[m(".Form.Form--centered",[this.success?[m("p.helpText",app.translator.trans("nearata-minecraft-avatars.forum.avatar_changed")),m(".Form-group",[m(s(),{class:"Button Button--primary Button--block",onclick:this.hide.bind(this)},app.translator.trans("nearata-minecraft-avatars.forum.dismiss_button"))])]:[m("p.helpText",app.translator.trans("nearata-minecraft-avatars.forum.help_text")),m(".Form-group",[m("input",{type:"name",name:"minotar",class:"FormControl",placeholder:this.oldMinotar||"Notch",oninput:function(a){return t.minotar=a.target.value},disabled:this.loading,autocomplete:"off"})]),m(".Form-group",[m(s(),{class:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("nearata-minecraft-avatars.forum.submit_button"))])]])]),m(".Modal-footer",[m("span",["Powered by ",m("a",{href:"https://crafatar.com/",target:"_blank"},"Crafatar")])])]},e.onsubmit=function(t){var a=this;t.preventDefault(),this.minotar!==this.oldMinotar?(this.loading=!0,this.alertAttrs=null,this.user.save({minotar:this.minotar},{errorHandler:this.onerror.bind(this),meta:{minotar:this.minotar}}).then((function(){return a.success=!0})).catch((function(){})).then(this.loaded.bind(this))):this.hide()},e.loaded=function(){delete this.user.avatarColor,t.prototype.loaded.call(this)},o}(t.n(f)());e().initializers.add("nearata-minecraft-avatars",(function(){var t="https://crafatar.com";u().prototype.avatarUrl=function(){var a=this.attribute("avatarUrl"),r=this.attribute("minotar");return r?t+"/avatars/"+r+"?size=64":a},(0,r.extend)(l().prototype,"controlItems",(function(a){var r=this,o=this.attrs.user.attribute("minotar"),n=e().translator.trans("nearata-minecraft-avatars.forum.change_button"),i=e().translator.trans("nearata-minecraft-avatars.forum.use_button");a.add("nearataMinecraftAvatars",m(s(),{icon:"fas fa-cloud-upload-alt",onclick:function(){return e().modal.show(d,{user:r.attrs.user})}},o?n:i),1);var u=this.attrs.user.avatarUrl();u?u.startsWith(t)?a.remove("upload"):a.remove("nearataMinecraftAvatars"):a.remove("remove")})),(0,r.override)(l().prototype,"quickUpload",(function(){})),(0,r.extend)(l().prototype,"remove",(function(){this.attrs.user.attribute("minotar")&&this.attrs.user.save({minotar:""}).then(this.success.bind(this),this.failure.bind(this))}))}))})(),module.exports=a})();
//# sourceMappingURL=forum.js.map