(()=>{var t={n:a=>{var r=a&&a.__esModule?()=>a.default:()=>a;return t.d(r,{a:r}),r},d:(a,r)=>{for(var o in r)t.o(r,o)&&!t.o(a,o)&&Object.defineProperty(a,o,{enumerable:!0,get:r[o]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},a={};(()=>{"use strict";function r(t,a){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},r(t,a)}t.r(a);const o=flarum.core.compat["common/components/Button"];var e=t.n(o);const n=flarum.core.compat["common/components/Switch"];var i=t.n(n);const s=flarum.core.compat["common/utils/Stream"];var c=t.n(s);const u=flarum.core.compat["forum/app"];var l=t.n(u);const f=flarum.core.compat["forum/components/UserPage"];var p=t.n(f),d=function(t){return l().translator.trans("nearata-minecraft-avatars.forum."+t)},h=function(t){var a,o;function n(){for(var a,r=arguments.length,o=new Array(r),e=0;e<r;e++)o[e]=arguments[e];return(a=t.call.apply(t,[this].concat(o))||this).switchLoading=void 0,a.loading=void 0,a.user=void 0,a.avatar=void 0,a}o=t,(a=n).prototype=Object.create(o.prototype),a.prototype.constructor=a,r(a,o);var s=n.prototype;return s.oninit=function(a){t.prototype.oninit.call(this,a),this.show(l().session.user),this.switchLoading=!1,this.loading=!1,this.avatar=c()(this.user.attribute("minotar")||"")},s.oncreate=function(a){t.prototype.oncreate.call(this,a),l().setTitle(d("page_title").toString())},s.content=function(){return m("div",{class:"MinecraftAvatarsPage"},m("div",{class:"Form"},m("div",{class:"Form-group"},m("input",{class:"FormControl",type:"text",name:"minotar",placeholder:d("placeholder"),autocomplete:"off",bidi:this.avatar}),m("p",{class:"helpText"},d("help_text"))),m("div",{class:"Form-group"},m(e(),{class:"Button Button--primary Button--block",disabled:this.loading||this.avatar()===this.user.attribute("minotar")||this.avatar().length<3,onclick:this.onButtonClick.bind(this)},d("submit_button"))),m("div",{class:"Form-group"},m(i(),{state:this.user.attribute("minotarEnabled"),loading:this.switchLoading,disabled:this.switchLoading,onchange:this.onSwitchChange.bind(this)},d("minotar_enabled")))))},s.onButtonClick=function(t){var a=this;this.loading=!0,this.user.save({minotar:this.avatar()}).then((function(){delete a.user.avatarColor,a.avatar(a.user.attribute("minotar"))})).catch((function(t){return console.error(t)})).finally((function(){a.loading=!1,m.redraw()}))},s.onSwitchChange=function(t){var a=this;this.switchLoading=!0,this.user.save({minotarEnabled:t}).then((function(){delete a.user.avatarColor})).catch((function(t){return console.error(t)})).finally((function(){a.switchLoading=!1,m.redraw()}))},n}(p());const v=flarum.core.compat["common/components/LinkButton"];var b=t.n(v);const g=flarum.core.compat["common/extend"],y=flarum.core.compat["common/models/User"];var _=t.n(y);l().initializers.add("nearata-minecraft-avatars",(function(){l().routes.minecraftAvatars={path:"/minecraft-avatars",component:h};var t=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{8}[0-9a-f]{4}[1-5][0-9a-f]{3}[89ab][0-9a-f]{3}[0-9a-f]{12})$/i;_().prototype.avatarUrl=function(){var a=this.attribute("minotar"),r=this.attribute("avatarUrl");if(!a)return r;if(!this.attribute("minotarEnabled"))return r;var o=new URL("https://crafatar.com/avatars/");return o.searchParams.append("size","64"),t.test(a)||(["MHF_Steve","MHF_Alex"].includes(a)?o.searchParams.append("default",a):o.searchParams.append("default","MHF_Steve"),a="00000000-0000-0000-0000-000000000000"),o.pathname+=a,o.toString()},(0,g.extend)(p().prototype,"navItems",(function(t){l().session.user===this.user&&t.add("nearataMinecraftAvatars",m(b(),{icon:"fas fa-cloud-upload-alt",href:l().route("minecraftAvatars")},l().translator.trans("nearata-minecraft-avatars.forum.userpage_nav_button")))}))}))})(),module.exports=a})();
//# sourceMappingURL=forum.js.map